{
  "chunk_index": 4,
  "result": "```markdown\n# 檔案區塊分析\n\n## 基本資訊\n- 檔名: MMBNewLoginViewModel.swift\n- 語言: swift\n- 區塊: 4/6\n- 行數: 200\n\n## 函式一覽\n- MMBNewLoginViewModel.fetchQuickLoginAgain() [614-632]\n  - 參數:\n    - (none)\n  - 回傳: Void\n  - 例外: none\n  - 副作用:\n    - 發送 loadingViewSubject (UI loading state)\n    - 呼叫 serviceMHMOT.queryLoginAgain (網路/非同步)\n    - 呼叫 saveToDataEngine (本地資料寫入)\n    - 呼叫 manager.handleLogin (登入流程處理)\n    - 發送 apiStateSubject (錯誤情況)\n\n- MMBNewLoginViewModel.fetchTwoStepVerificationLoginOtp() [636-652]\n  - 參數:\n    - (none)\n  - 回傳: Void\n  - 例外: none\n  - 副作用:\n    - 發送 loadingViewSubject\n    - 呼叫 serviceMHMOT.requestTwoStepAskLoginOtp (網路/非同步)\n    - 根據結果發送 apiStateSubject (成功或失敗)\n\n- MMBNewLoginViewModel.fetchFidoDeregister() [655-673]\n  - 參數:\n    - (none)\n  - 回傳: Void\n  - 例外: none\n  - 副作用:\n    - 發送 loadingViewSubject\n    - 呼叫 MMBDataEngine.sharedInstance().queryFidoDeregister (網路/非同步)\n    - 根據結果發送 apiStateSubject (成功或失敗)\n\n- MMBNewLoginViewModel.setupInitValue() [682-690]\n  - 參數:\n    - (none)\n  - 回傳: Void\n  - 例外: none\n  - 副作用:\n    - 設定 self.errorMappingTable (本地屬性)\n\n- MMBNewLoginViewModel.bindData() [693-798]\n  - 參數:\n    - (none)\n  - 回傳: Void\n  - 例外: none\n  - 副作用:\n    - 清除 self.cancellables\n    - 訂閱 manager.loginStatePublisher、manager.processLoginPublisher\n    - 在多個 sink 中呼叫多個內部方法 (e.g., deviceLockLoginAgainConfirmAction、handleFirstLogin、...、doAuthLoginWithStatusModel)\n    - 若使用 FIDO，訂閱 fidoLoginManager.loadingViewPublisher、fidoProcessStatePublisher\n    - 呼叫 fidoLoginManager.completeAuthentication()\n    - 發送 loadingViewSubject、navigationStateSubject、apiStateSubject\n    - 可能觸發 UI navigation、資料寫入、網路請求等\n\n## 外部相依\n- imports:\n  - (none in this chunk) — unknown\n\n## 函式關係（區塊內可觀察）\n- fetchQuickLoginAgain → loadingViewSubject.send (external/unknown)\n- fetchQuickLoginAgain → serviceMHMOT.queryLoginAgain (external/unknown)\n- fetchQuickLoginAgain → saveToDataEngine (internal, defined elsewhere)\n- fetchQuickLoginAgain → manager.handleLogin (external/unknown)\n- fetchQuickLoginAgain → apiStateSubject.send (external/unknown)\n\n- fetchTwoStepVerificationLoginOtp → loadingViewSubject.send (external/unknown)\n- fetchTwoStepVerificationLoginOtp → serviceMHMOT.requestTwoStepAskLoginOtp (external/unknown)\n- fetchTwoStepVerificationLoginOtp → apiStateSubject.send (external/unknown)\n\n- fetchFidoDeregister → loadingViewSubject.send (external/unknown)\n- fetchFidoDeregister → MMBDataEngine.sharedInstance().queryFidoDeregister (external/unknown)\n- fetchFidoDeregister → apiStateSubject.send (external/unknown)\n\n- setupInitValue → self.errorMappingTable (internal property)\n\n- bindData → self.cancellables.removeAll (internal)\n- bindData → manager.transForm().loginStatePublisher (external/unknown)\n- bindData → manager.transForm().processLoginPublisher (external/unknown)\n- bindData → doAuthLoginWithStatusModel (internal, defined elsewhere)\n- bindData → fidoLoginManager.transForm().loadingViewPublisher (external/unknown)\n- bindData → fidoLoginManager.transForm().fidoProcessStatePublisher (external/unknown)\n- bindData → fidoLoginManager.completeAuthentication (internal)\n- bindData → navigationStateSubject.send (external/unknown)\n- bindData → fetchFidoQuickLogin (internal, defined elsewhere)\n- bindData → apiStateSubject.send (external/unknown)\n\n## 摘要\n- 目的: 提供 MMBNewLoginViewModel 中與登入流程相關的 API 呼叫與資料綁定實作，包括快速登入、OTP 取得、FIDO 註銷以及內部資料初始化與 Combine 訂閱設定。\n- 範圍/邊界: 此區塊僅包含非同步服務呼叫、狀態發布、以及與 UI/資料層互動的副作用，未涉及 UI 元件本身的實作或底層網路層的細節。\n- 備註（若有重要不確定性）: 由於本區塊未顯示 import 陳述式，外部相依僅能以使用到的型別推測，實際模組來源可能需參考檔案開頭的 import 列表。\n```\n\n```mermaid\nflowchart TD\n    fetchQuickLoginAgain -->|send| loadingViewSubject\n    fetchQuickLoginAgain -->|call| serviceMHMOT_queryLoginAgain\n    fetchQuickLoginAgain -->|call| saveToDataEngine\n    fetchQuickLoginAgain -->|call| manager_handleLogin\n    fetchQuickLoginAgain -->|send| apiStateSubject_error\n\n    fetchTwoStepVerificationLoginOtp -->|send| loadingViewSubject\n    fetchTwoStepVerificationLoginOtp -->|call| serviceMHMOT_requestTwoStepAskLoginOtp\n    fetchTwoStepVerificationLoginOtp -->|send| apiStateSubject_success\n    fetchTwoStepVerificationLoginOtp -->|send| apiStateSubject_failure\n\n    fetchFidoDeregister -->|send| loadingViewSubject\n    fetchFidoDeregister -->|call| MMBDataEngine_queryFidoDeregister\n    fetchFidoDeregister -->|send| apiStateSubject_success\n    fetchFidoDeregister -->|send| apiStateSubject_failure\n\n    bindData -->|clear| cancellables\n    bindData -->|subscribe| loginStatePublisher\n    bindData -->|subscribe| processLoginPublisher\n    bindData -->|call| doAuthLoginWithStatusModel\n    bindData -->|subscribe| fidoLoadingPublisher\n    bindData -->|subscribe| fidoProcessStatePublisher\n    bindData -->|call| fidoLoginManager_completeAuthentication\n    bindData -->|send| navigationStateSubject\n    bindData -->|call| fetchFidoQuickLogin\n    bindData -->|send| apiStateSubject\n```",
  "timestamp": 1757928628.5181754
}